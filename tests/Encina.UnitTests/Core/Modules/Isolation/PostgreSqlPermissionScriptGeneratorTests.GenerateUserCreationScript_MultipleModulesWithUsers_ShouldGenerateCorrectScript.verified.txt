-- PostgreSQL Role Creation Script
-- Generated by Encina Module Isolation
-- IMPORTANT: Replace {{ModuleName_Password}} placeholders with actual passwords before execution
-- This script is idempotent and can be run multiple times safely

-- Create role for module: Orders
DO $$
BEGIN
    IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'orders_user') THEN
        CREATE ROLE "orders_user" WITH LOGIN PASSWORD '{{Orders_Password}}';
        RAISE NOTICE 'Created role: orders_user';
    ELSE
        RAISE NOTICE 'Role already exists: orders_user';
    END IF;
END $$;

-- Create role for module: Payments
DO $$
BEGIN
    IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'payments_user') THEN
        CREATE ROLE "payments_user" WITH LOGIN PASSWORD '{{Payments_Password}}';
        RAISE NOTICE 'Created role: payments_user';
    ELSE
        RAISE NOTICE 'Role already exists: payments_user';
    END IF;
END $$;

DO $$ BEGIN RAISE NOTICE 'Role creation completed successfully.'; END $$;
