-- PostgreSQL Permission Revoke Script
-- Generated by Encina Module Isolation
-- Use this script to clean up permissions before reconfiguring
-- This script is idempotent and can be run multiple times safely

-- Revoke permissions for module: Orders

-- Revoke default privileges in module schema: orders
ALTER DEFAULT PRIVILEGES IN SCHEMA "orders" REVOKE SELECT, INSERT, UPDATE, DELETE ON TABLES FROM "orders_user";
ALTER DEFAULT PRIVILEGES IN SCHEMA "orders" REVOKE EXECUTE ON FUNCTIONS FROM "orders_user";
ALTER DEFAULT PRIVILEGES IN SCHEMA "orders" REVOKE USAGE, SELECT ON SEQUENCES FROM "orders_user";
-- Revoke from module schema: orders
REVOKE ALL ON ALL TABLES IN SCHEMA "orders" FROM "orders_user";
REVOKE ALL ON ALL FUNCTIONS IN SCHEMA "orders" FROM "orders_user";
REVOKE ALL ON ALL SEQUENCES IN SCHEMA "orders" FROM "orders_user";
REVOKE USAGE ON SCHEMA "orders" FROM "orders_user";
DO $$ BEGIN RAISE NOTICE 'Revoked permissions on schema orders from orders_user'; END $$;

ALTER DEFAULT PRIVILEGES IN SCHEMA "lookup" REVOKE SELECT ON TABLES FROM "orders_user";
REVOKE SELECT ON ALL TABLES IN SCHEMA "lookup" FROM "orders_user";
REVOKE USAGE ON SCHEMA "lookup" FROM "orders_user";
DO $$ BEGIN RAISE NOTICE 'Revoked SELECT on schema lookup from orders_user'; END $$;
ALTER DEFAULT PRIVILEGES IN SCHEMA "shared" REVOKE SELECT ON TABLES FROM "orders_user";
REVOKE SELECT ON ALL TABLES IN SCHEMA "shared" FROM "orders_user";
REVOKE USAGE ON SCHEMA "shared" FROM "orders_user";
DO $$ BEGIN RAISE NOTICE 'Revoked SELECT on schema shared from orders_user'; END $$;
ALTER DEFAULT PRIVILEGES IN SCHEMA "audit" REVOKE SELECT ON TABLES FROM "orders_user";
REVOKE SELECT ON ALL TABLES IN SCHEMA "audit" FROM "orders_user";
REVOKE USAGE ON SCHEMA "audit" FROM "orders_user";
DO $$ BEGIN RAISE NOTICE 'Revoked SELECT on schema audit from orders_user'; END $$;

DO $$ BEGIN RAISE NOTICE 'Permission revokes completed successfully.'; END $$;
